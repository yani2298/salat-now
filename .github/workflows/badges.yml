name: 📊 Dynamic Badges & Stats

on:
  schedule:
    - cron: '0 6 * * *'  # Daily at 6 AM UTC
  push:
    branches: [main, master]
  workflow_dispatch:

permissions:
  contents: write
  pull-requests: write

jobs:
  update-badges:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Generate dynamic stats
        run: |
          # Create stats file with current metrics
          cat > .github/STATS.md << 'EOF'
          ## 📊 Project Statistics

          ### 🏆 GitHub Achievements Progress
          ![GitHub followers](https://img.shields.io/github/followers/yani2298?style=for-the-badge&logo=github)
          ![GitHub stars](https://img.shields.io/github/stars/yani2298/salat-now?style=for-the-badge&logo=github)
          ![GitHub forks](https://img.shields.io/github/forks/yani2298/salat-now?style=for-the-badge&logo=github)
          ![GitHub watchers](https://img.shields.io/github/watchers/yani2298/salat-now?style=for-the-badge&logo=github)

          ### 📈 Activity Metrics
          ![GitHub issues](https://img.shields.io/github/issues/yani2298/salat-now?style=for-the-badge&logo=github)
          ![GitHub pull requests](https://img.shields.io/github/issues-pr/yani2298/salat-now?style=for-the-badge&logo=github)
          ![GitHub last commit](https://img.shields.io/github/last-commit/yani2298/salat-now?style=for-the-badge&logo=git)
          ![GitHub commit activity](https://img.shields.io/github/commit-activity/m/yani2298/salat-now?style=for-the-badge&logo=git)

          ### 💻 Development
          ![GitHub code size](https://img.shields.io/github/languages/code-size/yani2298/salat-now?style=for-the-badge&logo=github)
          ![GitHub repo size](https://img.shields.io/github/repo-size/yani2298/salat-now?style=for-the-badge&logo=github)
          ![GitHub language count](https://img.shields.io/github/languages/count/yani2298/salat-now?style=for-the-badge&logo=github)
          ![Top language](https://img.shields.io/github/languages/top/yani2298/salat-now?style=for-the-badge&logo=typescript)

          ### 📦 Package
          ![NPM version](https://img.shields.io/npm/v/salat-times-calculator?style=for-the-badge&logo=npm)
          ![NPM downloads](https://img.shields.io/npm/dm/salat-times-calculator?style=for-the-badge&logo=npm)
          ![NPM downloads total](https://img.shields.io/npm/dt/salat-times-calculator?style=for-the-badge&logo=npm)

          ### 🌍 Community
          ![Contributors](https://img.shields.io/github/contributors/yani2298/salat-now?style=for-the-badge&logo=github)
          ![License](https://img.shields.io/github/license/yani2298/salat-now?style=for-the-badge&logo=opensource)

          ---
          *Auto-updated daily by GitHub Actions*
          EOF

      - name: Update README with enhanced badges
        run: |
          # Backup current README
          cp README.md README_backup.md
          
          # Add enhanced badge section after the main header
          sed -i '/^<div align="center">$/a\
          \
          ### 🏆 Achievement Badges\
          ![Profile views](https://komarev.com/ghpvc/?username=yani2298&style=for-the-badge&color=blueviolet)\
          ![GitHub followers](https://img.shields.io/github/followers/yani2298?style=for-the-badge&logo=github&color=blue)\
          ![Total repos](https://img.shields.io/badge/repos-public-green?style=for-the-badge&logo=github)\
          ![Years active](https://img.shields.io/badge/years%20active-2024+-brightgreen?style=for-the-badge&logo=github)\
          \
          ### 📊 Live Stats\
          ![GitHub stars](https://img.shields.io/github/stars/yani2298/salat-now?style=for-the-badge&logo=github&color=yellow)\
          ![GitHub forks](https://img.shields.io/github/forks/yani2298/salat-now?style=for-the-badge&logo=github&color=blue)\
          ![GitHub issues](https://img.shields.io/github/issues/yani2298/salat-now?style=for-the-badge&logo=github&color=red)\
          ![GitHub pull requests](https://img.shields.io/github/issues-pr/yani2298/salat-now?style=for-the-badge&logo=github&color=orange)\
          ' README.md

      - name: Create achievement dashboard
        run: |
          cat > .github/ACHIEVEMENT_DASHBOARD.md << 'EOF'
          # 🏆 GitHub Achievement Dashboard

          ![Achievement Progress](https://img.shields.io/badge/Achievement%20Progress-Active-brightgreen?style=for-the-badge&logo=github)

          ## 🎯 Current Achievements

          | Achievement | Status | Progress | Strategy |
          |-------------|--------|----------|----------|
          | ⭐ Starstruck | 🔄 In Progress | Growing | Community engagement |
          | 🦈 Pull Shark | 🔄 Active | Automated PRs | Daily automation |
          | ⚡ Quickdraw | 🔄 Active | Auto-close stale | Scheduled cleanup |
          | 👥 Pair Extraordinaire | 🔄 Active | Co-authored commits | Bot collaboration |
          | ❤️ Heart On Your Sleeve | ✅ Unlocked | Auto-reactions | Active system |
          | 🏔️ Arctic Code Vault | 🔄 Waiting | Contribute to archived | Next cycle |

          ## 📈 Progress Metrics

          ![GitHub Activity](https://github-readme-activity-graph.vercel.app/graph?username=yani2298&theme=react-dark&hide_border=true&area=true)

          ## 🎮 Achievement Strategy

          ### Daily Actions:
          - ✅ Auto-react to new issues/PRs
          - ✅ Create automated pull requests
          - ✅ Close stale issues quickly
          - ✅ Generate co-authored commits

          ### Community Engagement:
          - 🌍 Welcome new contributors
          - 🎉 Celebrate milestones
          - 💬 Encourage discussions
          - 🌟 Thank stargazers

          ### Long-term Goals:
          - 🚀 Reach 100+ stars
          - 👥 Build active contributor base
          - 📦 Maintain healthy package ecosystem
          - 🌍 Global Islamic tech community

          ---
          *Updated automatically every day*
          EOF

      - name: Commit updates
        run: |
          git config --global user.name "Badge Bot"
          git config --global user.email "badges@salatnow.app"
          git add .
          git commit -m "📊 Auto-update badges and achievement dashboard

          Co-authored-by: Anis Mosbah <contact@salatnow.app>
          Co-authored-by: Badge Bot <badges@salatnow.app>" || echo "No changes to commit"

      - name: Create PR for major updates
        if: github.event_name == 'workflow_dispatch'
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: "📊 Major badge and stats update"
          title: "📊 Enhanced Achievement Dashboard & Badges"
          body: |
            ## 📊 Badge & Achievement Enhancement

            This PR enhances our GitHub achievement strategy with:

            ### ✨ New Features:
            - 🏆 Enhanced achievement tracking dashboard
            - 📊 Dynamic stats and badges
            - 🎯 Real-time progress monitoring
            - 🤖 Automated badge updates

            ### 🎯 Achievement Goals:
            - **Pull Shark**: Contributing with automated PRs 🦈
            - **Quickdraw**: Fast issue management ⚡
            - **Heart On Your Sleeve**: Community engagement ❤️
            - **Pair Extraordinaire**: Collaborative commits 👥

            ### 📈 Benefits:
            - Better community visibility
            - Automated achievement tracking
            - Professional project presentation
            - Enhanced contributor experience

            **This is part of our professional GitHub achievement strategy! 🚀**
          branch: enhancement/achievement-badges
          delete-branch: true

  generate-social-proof:
    runs-on: ubuntu-latest
    needs: update-badges
    steps:
      - uses: actions/checkout@v4

      - name: Generate social proof content
        run: |
          cat > .github/SOCIAL_PROOF.md << 'EOF'
          # 🌟 Social Proof & Community

          ## 📱 Share Salat Now

          Help us reach more Muslim developers and users!

          ### 🐦 Twitter/X Templates:

          ```
          🕌 Just discovered Salat Now - a beautiful macOS menu bar app for prayer times!

          ✅ Accurate prayer calculations
          ✅ Beautiful, minimal design  
          ✅ Free & open source
          ✅ Privacy-first approach

          Perfect for Muslim professionals! 🚀

          #SalatNow #IslamicTech #macOS #OpenSource
          https://github.com/yani2298/salat-now
          ```

          ### 📋 Reddit Templates:

          **r/islam:**
          > Found this excellent prayer times app for macOS. Clean interface, accurate times, and completely free. Great for keeping track of prayers while working.

          **r/MacOS:**
          > Salat Now - Professional prayer times in your menu bar. Beautiful design and perfect integration with macOS.

          **r/opensourceisbeautiful:**
          > Clean, minimal Islamic prayer times calculator with TypeScript/React. Great example of focused, purposeful software.

          ### 💬 Discord/Communities:

          ```
          Hey everyone! 👋

          I've been using Salat Now for my daily prayers and it's fantastic! 

          🕌 Accurate prayer times for any location
          ⚡ Lightweight menu bar integration
          🎨 Beautiful, respectful design
          🔓 Completely open source

          Perfect for Muslim developers and professionals working on Mac!

          Check it out: https://github.com/yani2298/salat-now
          ```

          ## 🎯 Community Targets

          ### Islamic Tech Communities:
          - Muslim Developers Slack
          - Islamic Tech Facebook Groups  
          - Reddit r/islam
          - Productive Muslim forums

          ### Developer Communities:
          - Reddit r/MacOS, r/electronjs
          - Hacker News
          - Dev.to Islamic Tech tags
          - Twitter #IslamicTech hashtag

          ### App Showcase:
          - Product Hunt
          - MacUpdate
          - AlternativeTo
          - GitHub Trending

          ---
          *Help us spread the word! JazakAllahu Khair! 🤲*
          EOF

      - name: Commit social proof content
        run: |
          git config --global user.name "Community Bot"
          git config --global user.email "community@salatnow.app"
          git add .github/SOCIAL_PROOF.md
          git commit -m "🌍 Add social proof and sharing templates

          Co-authored-by: Anis Mosbah <contact@salatnow.app>" || echo "No changes" 